"0","#' Capitale Minimo"
"0","#'"
"0","#' @param numeroAssicurati "
"0","#' @param eta "
"0","#' @param rata "
"0","#' @param numeroPremi "
"0","#' @param omega "
"0","#' @param differimento "
"0","#' @param temporanea "
"0","#' @param anniCopertura "
"0","#' @param rateGarantiteDurata "
"0","#' @param rendimentoFondoAnnuo "
"0","#' @param tassoAleatorio "
"0","#' @param tavolaMortalita "
"0","#' @param tassoTecnico "
"0","#' @param tavolaPeriodo "
"0","#' @param andamentoFondo "
"0","#' @param rendimentoFondo "
"0","#' @param decessi "
"0","#' @param precisione "
"0","#'"
"0","#' @return"
"0","#' @export"
"0","#'"
"0","#' @examples"
"0","capitaleMinimo = function (numeroAssicurati = 1000,"
"0","                           eta = 20,"
"0","                           rata = 1000,"
"0","                           numeroPremi = 15,"
"0","                           omega = 110,"
"0","                           differimento = 25,"
"0","                           temporanea = FALSE,"
"0","                           # temporanea o  vita intera"
"0","                           anniCopertura = 35,"
"0","                           rateGarantiteDurata = 5,"
"0","                           rendimentoFondoAnnuo = 0.01,"
"0","                           # tasso finanziario"
"0","                           tassoAleatorio = TRUE,"
"0","                           tavolaMortalita = demoIta$RG48M,"
"0","                           #tavola utilizzata per la base tecnica"
"0","                           tassoTecnico = 0.02,"
"0","                           #tasso utilizzato per la base tecnica"
"0","                           tavolaPeriodo = demoIta$SIM02,"
"0","                           precisione = 1000, anno = 90)"
"0","{"
"0","  capitaleMinimo = 0"
"0","  x = 0"
"0","  for (i in 1:precisione)"
"0","  {"
"0","    x[i] ="
"0","      gestionePortafoglio("
"0","        numeroAssicurati = numeroAssicurati,"
"0","        eta = eta,"
"0","        rata = rata,"
"0","        numeroPremi = numeroPremi,"
"0","        omega = omega,"
"0","        differimento = differimento,"
"0","        temporanea = temporanea,"
"0","        anniCopertura = anniCopertura,"
"0","        rateGarantiteDurata = rateGarantiteDurata,"
"0","        rendimentoFondoAnnuo = rendimentoFondoAnnuo,"
"0","        tassoAleatorio = tassoAleatorio,"
"0","        tavolaMortalita = tavolaMortalita,"
"0","        tassoTecnico = tassoTecnico,"
"0","        tavolaPeriodo = tavolaPeriodo,"
"0","        fondoInizio = capitaleMinimo"
"0","      )$andamentoFondo[anno]"
"0","  }"
"0","  while (MonteCarlo(x)$rovina > 0.05)"
"0","  {"
"0","    capitaleMinimo = capitaleMinimo + abs(quantile(x, probs = 0.05)) / ifelse(MonteCarlo(x)$rovina > 0.9,"
"0","                                                      8,"
"0","                                                      ifelse("
"0","                                                        MonteCarlo(x)$rovina > 0.1,"
"0","                                                        20,"
"0","                                                        ifelse(MonteCarlo(x)$rovina > 0.08, 30, 40)"
"0","                                                      ))"
"0","    # print(capitaleMinimo)"
"0","    probabilitaRovina = MonteCarlo(x)$rovina"
"0","    # print(probabilitaRovina)"
"0","    for (i in 1:precisione)"
"0","    {"
"0","      x[i] = gestionePortafoglio("
"0","        numeroAssicurati = numeroAssicurati,"
"0","        eta = eta,"
"0","        rata = rata,"
"0","        numeroPremi = numeroPremi,"
"0","        omega = omega,"
"0","        differimento = differimento,"
"0","        temporanea = temporanea,"
"0","        anniCopertura = anniCopertura,"
"0","        rateGarantiteDurata = rateGarantiteDurata,"
"0","        rendimentoFondoAnnuo = rendimentoFondoAnnuo,"
"0","        tassoAleatorio = tassoAleatorio,"
"0","        tavolaMortalita = tavolaMortalita,"
"0","        tassoTecnico = tassoTecnico,"
"0","        tavolaPeriodo = tavolaPeriodo,"
"0","        fondoInizio = capitaleMinimo"
"0","      )$andamentoFondo[anno]"
"0","    }"
"0","  }"
"0","  return(capitaleMinimo)"
"0","}"
"0",""
"0","capMin = capitaleMinimo(rendimentoFondoAnnuo = 0.015,tassoTecnico = 0.02,precisione = 100)"
"0","capMin"
"1","     5% "
"1","
"
"1","5530725 "
"1","
"
